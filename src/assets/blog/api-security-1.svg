<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#ef4444"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#f59e0b"/>
    </marker>
    <marker id="arrowGray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Dark background -->
  <rect width="1200" height="800" fill="#0f172a"/>

  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" fill="#f1f5f9" font-size="24" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Healthcare API Attack Surface</text>

  <!-- External Attack Vectors -->
  <g id="external-threats">
    <!-- Internet Cloud -->
    <ellipse cx="150" cy="150" rx="80" ry="50" fill="#1e293b" stroke="#ef4444" stroke-width="2"/>
    <text x="150" y="145" text-anchor="middle" fill="#ef4444" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Internet</text>
    <text x="150" y="165" text-anchor="middle" fill="#ef4444" font-size="12" font-family="system-ui, -apple-system, sans-serif">Attack Vector</text>

    <!-- Mobile Apps -->
    <rect x="50" y="240" width="100" height="80" rx="8" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
    <text x="100" y="275" text-anchor="middle" fill="#f59e0b" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Mobile Apps</text>
    <text x="100" y="295" text-anchor="middle" fill="#f59e0b" font-size="11" font-family="system-ui, -apple-system, sans-serif">Credential Theft</text>

    <!-- Third-party Integrations -->
    <rect x="200" y="240" width="100" height="80" rx="8" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
    <text x="250" y="268" text-anchor="middle" fill="#f59e0b" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Third-party</text>
    <text x="250" y="288" text-anchor="middle" fill="#f59e0b" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Integrations</text>
    <text x="250" y="308" text-anchor="middle" fill="#f59e0b" font-size="11" font-family="system-ui, -apple-system, sans-serif">API Abuse</text>
  </g>

  <!-- Trust Boundary 1 -->
  <rect x="380" y="80" width="440" height="280" rx="8" fill="none" stroke="#8b5cf6" stroke-width="3" stroke-dasharray="10,5"/>
  <text x="600" y="105" text-anchor="middle" fill="#8b5cf6" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">TRUST BOUNDARY: DMZ</text>

  <!-- API Gateway Layer -->
  <g id="gateway">
    <rect x="420" y="130" width="360" height="100" rx="8" fill="#1e293b" stroke="#8b5cf6" stroke-width="2"/>
    <text x="600" y="160" text-anchor="middle" fill="#8b5cf6" font-size="16" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">API Gateway</text>

    <rect x="440" y="175" width="140" height="40" rx="6" fill="#312e81" stroke="#8b5cf6" stroke-width="1"/>
    <text x="510" y="195" text-anchor="middle" fill="#c4b5fd" font-size="12" font-family="system-ui, -apple-system, sans-serif">WAF</text>
    <text x="510" y="210" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">OWASP Top 10</text>

    <rect x="620" y="175" width="140" height="40" rx="6" fill="#312e81" stroke="#8b5cf6" stroke-width="1"/>
    <text x="690" y="195" text-anchor="middle" fill="#c4b5fd" font-size="12" font-family="system-ui, -apple-system, sans-serif">Rate Limiting</text>
    <text x="690" y="210" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">Data Exfiltration</text>
  </g>

  <!-- Authentication Service -->
  <rect x="420" y="250" width="160" height="90" rx="8" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
  <text x="500" y="280" text-anchor="middle" fill="#3b82f6" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Auth Service</text>
  <text x="500" y="300" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">OAuth 2.0</text>
  <text x="500" y="315" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">SMART on FHIR</text>
  <text x="500" y="330" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">PKCE</text>

  <!-- TLS Indicator -->
  <text x="350" y="190" fill="#10b981" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">TLS 1.3</text>
  <text x="340" y="205" fill="#10b981" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Termination</text>

  <!-- Trust Boundary 2 -->
  <rect x="380" y="390" width="440" height="180" rx="8" fill="none" stroke="#ec4899" stroke-width="3" stroke-dasharray="10,5"/>
  <text x="600" y="415" text-anchor="middle" fill="#ec4899" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">TRUST BOUNDARY: INTERNAL</text>

  <!-- Application APIs -->
  <g id="application-apis">
    <rect x="420" y="435" width="110" height="70" rx="8" fill="#1e293b" stroke="#10b981" stroke-width="2"/>
    <text x="475" y="460" text-anchor="middle" fill="#10b981" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">FHIR API</text>
    <text x="475" y="478" text-anchor="middle" fill="#6ee7b7" font-size="10" font-family="system-ui, -apple-system, sans-serif">BOLA Risk</text>
    <text x="475" y="493" text-anchor="middle" fill="#6ee7b7" font-size="10" font-family="system-ui, -apple-system, sans-serif">Patient Data</text>

    <rect x="555" y="435" width="110" height="70" rx="8" fill="#1e293b" stroke="#10b981" stroke-width="2"/>
    <text x="610" y="460" text-anchor="middle" fill="#10b981" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">REST API</text>
    <text x="610" y="478" text-anchor="middle" fill="#6ee7b7" font-size="10" font-family="system-ui, -apple-system, sans-serif">Access Control</text>
    <text x="610" y="493" text-anchor="middle" fill="#6ee7b7" font-size="10" font-family="system-ui, -apple-system, sans-serif">Authorization</text>

    <rect x="690" y="435" width="110" height="70" rx="8" fill="#1e293b" stroke="#10b981" stroke-width="2"/>
    <text x="745" y="460" text-anchor="middle" fill="#10b981" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">HL7 Interface</text>
    <text x="745" y="478" text-anchor="middle" fill="#6ee7b7" font-size="10" font-family="system-ui, -apple-system, sans-serif">Legacy Systems</text>
    <text x="745" y="493" text-anchor="middle" fill="#6ee7b7" font-size="10" font-family="system-ui, -apple-system, sans-serif">Integration</text>
  </g>

  <!-- Trust Boundary 3 -->
  <rect x="380" y="600" width="440" height="160" rx="8" fill="none" stroke="#f59e0b" stroke-width="3" stroke-dasharray="10,5"/>
  <text x="600" y="625" text-anchor="middle" fill="#f59e0b" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">TRUST BOUNDARY: DATA LAYER</text>

  <!-- Database Layer -->
  <g id="database">
    <rect x="420" y="650" width="200" height="85" rx="8" fill="#1e293b" stroke="#ec4899" stroke-width="2"/>
    <text x="520" y="675" text-anchor="middle" fill="#ec4899" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Patient Database</text>
    <text x="520" y="695" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">Encrypted at Rest</text>
    <text x="520" y="710" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">Field-level Encryption</text>
    <text x="520" y="725" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">KMS Key Management</text>
  </g>

  <!-- Audit & SIEM -->
  <rect x="640" y="650" width="160" height="85" rx="8" fill="#1e293b" stroke="#ec4899" stroke-width="2"/>
  <text x="720" y="675" text-anchor="middle" fill="#ec4899" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Audit &amp; SIEM</text>
  <text x="720" y="695" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">Immutable Logs</text>
  <text x="720" y="710" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">All Access Tracked</text>
  <text x="720" y="725" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">HIPAA Compliance</text>

  <!-- Attack Paths -->
  <g id="attack-paths" stroke-width="2" stroke-dasharray="5,5" fill="none">
    <!-- Credential Theft Path -->
    <path d="M 150 200 L 420 180" stroke="#ef4444" marker-end="url(#arrowRed)"/>
    <text x="260" y="175" fill="#ef4444" font-size="11" font-family="system-ui, -apple-system, sans-serif">Credential Theft</text>

    <!-- API Abuse Path -->
    <path d="M 300 280 L 420 200" stroke="#f59e0b" marker-end="url(#arrowOrange)"/>
    <text x="340" y="230" fill="#f59e0b" font-size="11" font-family="system-ui, -apple-system, sans-serif">API Abuse</text>

    <!-- BOLA Path -->
    <path d="M 580 230 L 475 435" stroke="#ef4444" marker-end="url(#arrowRed)"/>
    <text x="500" y="350" fill="#ef4444" font-size="11" font-family="system-ui, -apple-system, sans-serif">BOLA Attack</text>

    <!-- Data Exfiltration Path -->
    <path d="M 610 505 L 520 650" stroke="#f59e0b" marker-end="url(#arrowOrange)"/>
    <text x="540" y="590" fill="#f59e0b" font-size="11" font-family="system-ui, -apple-system, sans-serif">Data Exfiltration</text>
  </g>

  <!-- Flow Arrows -->
  <g id="normal-flow" stroke-width="2" fill="none">
    <path d="M 150 200 L 420 180" stroke="#64748b" marker-end="url(#arrowGray)"/>
    <path d="M 600 230 L 600 435" stroke="#64748b" marker-end="url(#arrowGray)"/>
    <path d="M 600 505 L 520 650" stroke="#64748b" marker-end="url(#arrowGray)"/>
  </g>

  <!-- Legend -->
  <g id="legend">
    <rect x="880" y="130" width="280" height="220" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
    <text x="1020" y="160" text-anchor="middle" fill="#f1f5f9" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Common Attack Vectors</text>

    <circle cx="900" cy="185" r="5" fill="#ef4444"/>
    <text x="920" y="190" fill="#f1f5f9" font-size="12" font-family="system-ui, -apple-system, sans-serif">Credential Theft</text>

    <circle cx="900" cy="210" r="5" fill="#ef4444"/>
    <text x="920" y="215" fill="#f1f5f9" font-size="12" font-family="system-ui, -apple-system, sans-serif">BOLA (Broken Auth)</text>

    <circle cx="900" cy="235" r="5" fill="#f59e0b"/>
    <text x="920" y="240" fill="#f1f5f9" font-size="12" font-family="system-ui, -apple-system, sans-serif">API Abuse</text>

    <circle cx="900" cy="260" r="5" fill="#f59e0b"/>
    <text x="920" y="265" fill="#f1f5f9" font-size="12" font-family="system-ui, -apple-system, sans-serif">Data Exfiltration</text>

    <line x1="900" y1="285" x2="1140" y2="285" stroke="#475569" stroke-width="1"/>

    <rect x="900" y="295" width="15" height="15" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="3,2"/>
    <text x="920" y="307" fill="#f1f5f9" font-size="12" font-family="system-ui, -apple-system, sans-serif">DMZ Trust Boundary</text>

    <rect x="900" y="318" width="15" height="15" fill="none" stroke="#ec4899" stroke-width="2" stroke-dasharray="3,2"/>
    <text x="920" y="330" fill="#f1f5f9" font-size="12" font-family="system-ui, -apple-system, sans-serif">Internal Trust Boundary</text>
  </g>

  <!-- Key Security Controls Box -->
  <g id="controls">
    <rect x="880" y="370" width="280" height="200" rx="8" fill="#1e293b" stroke="#475569" stroke-width="1"/>
    <text x="1020" y="400" text-anchor="middle" fill="#f1f5f9" font-size="14" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Key Security Controls</text>

    <text x="900" y="425" fill="#10b981" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">✓ TLS 1.3 Encryption</text>
    <text x="900" y="445" fill="#10b981" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">✓ WAF Protection</text>
    <text x="900" y="465" fill="#10b981" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">✓ Rate Limiting</text>
    <text x="900" y="485" fill="#10b981" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">✓ OAuth 2.0 + PKCE</text>
    <text x="900" y="505" fill="#10b981" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">✓ Field Encryption (KMS)</text>
    <text x="900" y="525" fill="#10b981" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">✓ Audit Logging</text>
    <text x="900" y="545" fill="#10b981" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">✓ Patient-Level Access Control</text>
  </g>

</svg>