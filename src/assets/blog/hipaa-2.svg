<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900">
  <defs>
    <style>
      .bg { fill: #0f172a; }
      .title { fill: #e2e8f0; font-family: 'Arial', sans-serif; font-size: 24px; font-weight: bold; }
      .subtitle { fill: #cbd5e1; font-family: 'Arial', sans-serif; font-size: 16px; font-weight: bold; }
      .text { fill: #e2e8f0; font-family: 'Arial', sans-serif; font-size: 14px; }
      .small-text { fill: #cbd5e1; font-family: 'Arial', sans-serif; font-size: 12px; }
      .actor { fill: #8b5cf6; stroke: #a78bfa; stroke-width: 2; }
      .system { fill: #3b82f6; stroke: #60a5fa; stroke-width: 2; }
      .process { fill: #10b981; stroke: #34d399; stroke-width: 2; }
      .timeout { fill: #ec4899; stroke: #f472b6; stroke-width: 2; }
      .line { stroke: #64748b; stroke-width: 2; fill: none; }
      .arrow { fill: #64748b; }
      .success { stroke: #10b981; stroke-width: 2; fill: none; }
      .arrow-success { fill: #10b981; }
    </style>
  </defs>

  <!-- Background -->
  <rect class="bg" width="1200" height="900"/>

  <!-- Title -->
  <text class="title" x="600" y="40" text-anchor="middle">HIPAA-Compliant Authentication Flow</text>

  <!-- Actors -->
  <rect class="actor" x="50" y="80" width="120" height="60" rx="8"/>
  <text class="text" x="110" y="115" text-anchor="middle">User</text>

  <rect class="system" x="250" y="80" width="120" height="60" rx="8"/>
  <text class="text" x="310" y="115" text-anchor="middle">Mobile App</text>

  <rect class="system" x="450" y="80" width="120" height="60" rx="8"/>
  <text class="text" x="510" y="115" text-anchor="middle">Backend API</text>

  <rect class="system" x="650" y="80" width="120" height="60" rx="8"/>
  <text class="text" x="710" y="115" text-anchor="middle">Auth Service</text>

  <rect class="system" x="850" y="80" width="120" height="60" rx="8"/>
  <text class="text" x="910" y="115" text-anchor="middle">MFA Provider</text>

  <rect class="system" x="1050" y="80" width="120" height="60" rx="8"/>
  <text class="text" x="1110" y="115" text-anchor="middle">Audit Logger</text>

  <!-- Vertical lines for sequence -->
  <line class="line" x1="110" y1="140" x2="110" y2="850"/>
  <line class="line" x1="310" y1="140" x2="310" y2="850"/>
  <line class="line" x1="510" y1="140" x2="510" y2="850"/>
  <line class="line" x1="710" y1="140" x2="710" y2="850"/>
  <line class="line" x1="910" y1="140" x2="910" y2="850"/>
  <line class="line" x1="1110" y1="140" x2="1110" y2="850"/>

  <!-- Step 1: Enter Credentials -->
  <polygon class="arrow" points="110,170 310,170 310,165 320,175 310,185 310,180 110,180"/>
  <text class="small-text" x="210" y="165" text-anchor="middle">1. Enter credentials</text>

  <!-- Step 2: Send to Backend -->
  <polygon class="arrow" points="310,210 510,210 510,205 520,215 510,225 510,220 310,220"/>
  <text class="small-text" x="410" y="205" text-anchor="middle">2. POST /auth/login</text>

  <!-- Step 3: Validate -->
  <polygon class="arrow" points="510,250 710,250 710,245 720,255 710,265 710,260 510,260"/>
  <text class="small-text" x="610" y="245" text-anchor="middle">3. Validate credentials</text>

  <!-- Step 4: Log attempt -->
  <polygon class="arrow" points="710,290 1110,290 1110,285 1120,295 1110,305 1110,300 710,300"/>
  <text class="small-text" x="910" y="285" text-anchor="middle">4. Log auth attempt</text>

  <!-- Step 5: Request MFA -->
  <polygon class="arrow" points="710,330 910,330 910,325 920,335 910,345 910,340 710,340"/>
  <text class="small-text" x="810" y="325" text-anchor="middle">5. Request MFA code</text>

  <!-- Step 6: Send MFA -->
  <polygon class="arrow" points="920,370 110,370 110,365 100,375 110,385 110,380 920,380"/>
  <text class="small-text" x="515" y="365" text-anchor="middle">6. Send MFA (SMS/Email/App)</text>

  <!-- Step 7: User enters MFA -->
  <polygon class="arrow" points="110,410 310,410 310,405 320,415 310,425 310,420 110,420"/>
  <text class="small-text" x="210" y="405" text-anchor="middle">7. Enter MFA code</text>

  <!-- Step 8: Submit MFA -->
  <polygon class="arrow" points="310,450 710,450 710,445 720,455 710,465 710,460 310,460"/>
  <text class="small-text" x="510" y="445" text-anchor="middle">8. POST /auth/verify-mfa</text>

  <!-- Step 9: Verify MFA -->
  <polygon class="arrow" points="710,490 910,490 910,485 920,495 910,505 910,500 710,500"/>
  <text class="small-text" x="810" y="485" text-anchor="middle">9. Verify code</text>

  <!-- Step 10: MFA Success -->
  <polygon class="arrow-success" points="920,530 710,530 710,525 700,535 710,545 710,540 920,540"/>
  <text class="small-text" x="815" y="525" text-anchor="middle" fill="#10b981">10. MFA verified</text>

  <!-- Step 11: Generate JWT -->
  <rect class="process" x="640" y="560" width="140" height="40" rx="4"/>
  <text class="small-text" x="710" y="585" text-anchor="middle">11. Generate JWT</text>
  <text class="small-text" x="710" y="600" text-anchor="middle">with user roles</text>

  <!-- Step 12: Log success -->
  <polygon class="arrow" points="710,620 1110,620 1110,615 1120,625 1110,635 1110,630 710,630"/>
  <text class="small-text" x="910" y="615" text-anchor="middle">12. Log successful auth</text>

  <!-- Step 13: Return token -->
  <polygon class="arrow-success" points="720,660 310,660 310,655 300,665 310,675 310,670 720,670"/>
  <text class="small-text" x="515" y="655" text-anchor="middle" fill="#10b981">13. Return JWT token</text>

  <!-- Step 14: Access resources -->
  <polygon class="arrow" points="310,700 510,700 510,695 520,705 510,715 510,710 310,710"/>
  <text class="small-text" x="410" y="695" text-anchor="middle">14. Access protected resource</text>

  <!-- Step 15: Validate RBAC -->
  <rect class="process" x="440" y="730" width="140" height="40" rx="4"/>
  <text class="small-text" x="510" y="755" text-anchor="middle">15. Validate JWT</text>
  <text class="small-text" x="510" y="770" text-anchor="middle">+ RBAC check</text>

  <!-- Step 16: Log access -->
  <polygon class="arrow" points="510,790 1110,790 1110,785 1120,795 1110,805 1110,800 510,800"/>
  <text class="small-text" x="810" y="785" text-anchor="middle">16. Log resource access</text>

  <!-- Session timeout indicator -->
  <rect class="timeout" x="50" y="830" width="480" height="50" rx="8"/>
  <text class="text" x="290" y="860" text-anchor="middle">Session Timeout: Auto-logout after 15 minutes inactivity</text>
</svg>