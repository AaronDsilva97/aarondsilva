<svg viewBox="0 0 1000 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1000" height="900" fill="#0f172a"/>

  <!-- Title -->
  <text x="500" y="40" font-family="system-ui, -apple-system, sans-serif" font-size="24" font-weight="600" fill="#e2e8f0" text-anchor="middle">MCP Security Architecture</text>
  <text x="500" y="65" font-family="system-ui, -apple-system, sans-serif" font-size="14" fill="#94a3b8" text-anchor="middle">Threats and defense mechanisms for MCP implementations</text>

  <!-- Central Security Layer -->
  <g id="security-center">
    <!-- Shield -->
    <path d="M 500 250 L 500 450 Q 500 480, 480 500 Q 460 520, 420 530 Q 400 535, 390 535
             L 390 535 Q 380 535, 360 530 Q 320 520, 300 500 Q 280 480, 280 450 L 280 250
             Q 280 240, 290 235 L 390 190 L 490 235 Q 500 240, 500 250 Z"
          fill="url(#shield-grad)" stroke="#10b981" stroke-width="4"/>

    <defs>
      <linearGradient id="shield-grad" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" style="stop-color:#10b981;stop-opacity:0.3" />
        <stop offset="100%" style="stop-color:#10b981;stop-opacity:0.1" />
      </linearGradient>
    </defs>

    <!-- Checkmark in shield -->
    <path d="M 330 350 L 370 390 L 450 310" fill="none" stroke="#10b981" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>

    <text x="390" y="580" font-family="system-ui, -apple-system, sans-serif" font-size="20" font-weight="700" fill="#e2e8f0" text-anchor="middle">MCP Security Layer</text>
  </g>

  <!-- Threat Vectors (Inner circle with X marks) -->

  <!-- Threat 1: Prompt Injection (Top) -->
  <g id="threat1">
    <circle cx="390" cy="120" r="50" fill="#ef4444" opacity="0.2" stroke="#ef4444" stroke-width="3"/>
    <line x1="370" y1="100" x2="410" y2="140" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <line x1="410" y1="100" x2="370" y2="140" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <text x="390" y="65" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Prompt</text>
    <text x="390" y="82" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Injection</text>
  </g>

  <!-- Threat 2: Tool Hijacking (Right) -->
  <g id="threat2">
    <circle cx="600" cy="300" r="50" fill="#ef4444" opacity="0.2" stroke="#ef4444" stroke-width="3"/>
    <line x1="580" y1="280" x2="620" y2="320" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <line x1="620" y1="280" x2="580" y2="320" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <text x="600" y="245" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Tool</text>
    <text x="600" y="262" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Hijacking</text>
  </g>

  <!-- Threat 3: Data Exfiltration (Bottom) -->
  <g id="threat3">
    <circle cx="390" cy="630" r="50" fill="#ef4444" opacity="0.2" stroke="#ef4444" stroke-width="3"/>
    <line x1="370" y1="610" x2="410" y2="650" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <line x1="410" y1="610" x2="370" y2="650" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <text x="390" y="705" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Data</text>
    <text x="390" y="722" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Exfiltration</text>
  </g>

  <!-- Threat 4: Unauthorized Access (Left) -->
  <g id="threat4">
    <circle cx="180" cy="300" r="50" fill="#ef4444" opacity="0.2" stroke="#ef4444" stroke-width="3"/>
    <line x1="160" y1="280" x2="200" y2="320" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <line x1="200" y1="280" x2="160" y2="320" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/>
    <text x="180" y="245" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Unauthorized</text>
    <text x="180" y="262" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#ef4444" text-anchor="middle">Access</text>
  </g>

  <!-- Defense Mechanisms (Outer ring with checkmarks) -->

  <!-- Defense 1: Input Validation (Top) -->
  <g id="defense1">
    <rect x="290" y="20" width="200" height="80" rx="8" fill="#10b981" opacity="0.2" stroke="#10b981" stroke-width="3"/>
    <circle cx="330" cy="60" r="18" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="2"/>
    <path d="M 322 60 L 328 66 L 338 54" fill="none" stroke="#10b981" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="360" y="55" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Input</text>
    <text x="360" y="72" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Validation</text>
  </g>

  <!-- Defense 2: Permission Scoping (Top Right) -->
  <g id="defense2">
    <rect x="650" y="100" width="220" height="80" rx="8" fill="#10b981" opacity="0.2" stroke="#10b981" stroke-width="3"/>
    <circle cx="690" cy="140" r="18" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="2"/>
    <path d="M 682 140 L 688 146 L 698 134" fill="none" stroke="#10b981" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="720" y="135" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Permission</text>
    <text x="720" y="152" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Scoping</text>
  </g>

  <!-- Defense 3: Audit Logging (Bottom Right) -->
  <g id="defense3">
    <rect x="650" y="520" width="200" height="80" rx="8" fill="#10b981" opacity="0.2" stroke="#10b981" stroke-width="3"/>
    <circle cx="690" cy="560" r="18" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="2"/>
    <path d="M 682 560 L 688 566 L 698 554" fill="none" stroke="#10b981" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="720" y="555" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Audit</text>
    <text x="720" y="572" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Logging</text>
  </g>

  <!-- Defense 4: Encryption (Bottom Left) -->
  <g id="defense4">
    <rect x="100" y="650" width="180" height="80" rx="8" fill="#10b981" opacity="0.2" stroke="#10b981" stroke-width="3"/>
    <circle cx="140" cy="690" r="18" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="2"/>
    <path d="M 132 690 L 138 696 L 148 684" fill="none" stroke="#10b981" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="170" y="685" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Encryption</text>
    <text x="170" y="702" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">(TLS/SSL)</text>
  </g>

  <!-- Defense 5: Authentication (Left) -->
  <g id="defense5">
    <rect x="30" y="100" width="200" height="80" rx="8" fill="#10b981" opacity="0.2" stroke="#10b981" stroke-width="3"/>
    <circle cx="70" cy="140" r="18" fill="#10b981" opacity="0.3" stroke="#10b981" stroke-width="2"/>
    <path d="M 62 140 L 68 146 L 78 134" fill="none" stroke="#10b981" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="100" y="135" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">Authentication</text>
    <text x="100" y="152" font-family="system-ui, -apple-system, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">&amp; Authorization</text>
  </g>

  <!-- Connection lines from threats to center (dashed red) -->
  <line x1="390" y1="170" x2="390" y2="250" stroke="#ef4444" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>
  <line x1="550" y1="300" x2="500" y2="360" stroke="#ef4444" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>
  <line x1="390" y1="580" x2="390" y2="530" stroke="#ef4444" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>
  <line x1="230" y1="300" x2="280" y2="360" stroke="#ef4444" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>

  <!-- Connection lines from defenses outward (solid green) -->
  <line x1="390" y1="100" x2="390" y2="20" stroke="#10b981" stroke-width="2" opacity="0.5"/>
  <line x1="600" y1="180" x2="650" y2="140" stroke="#10b981" stroke-width="2" opacity="0.5"/>
  <line x1="600" y1="560" x2="650" y2="560" stroke="#10b981" stroke-width="2" opacity="0.5"/>
  <line x1="280" y1="630" x2="280" y2="690" stroke="#10b981" stroke-width="2" opacity="0.5"/>
  <line x1="180" y1="180" x2="130" y2="140" stroke="#10b981" stroke-width="2" opacity="0.5"/>

  <!-- Legend -->
  <g id="legend" transform="translate(350, 800)">
    <rect x="0" y="0" width="280" height="70" rx="8" fill="#1e293b" stroke="#475569" stroke-width="2"/>
    <text x="140" y="25" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600" fill="#e2e8f0" text-anchor="middle">Security Model</text>
    <circle cx="40" cy="50" r="8" fill="#ef4444" opacity="0.5"/>
    <text x="55" y="55" font-family="system-ui, -apple-system, sans-serif" font-size="12" fill="#94a3b8">Threats</text>
    <circle cx="150" cy="50" r="8" fill="#10b981" opacity="0.5"/>
    <text x="165" y="55" font-family="system-ui, -apple-system, sans-serif" font-size="12" fill="#94a3b8">Defenses</text>
  </g>
</svg>