<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#8b5cf6" />
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#10b981" />
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ef4444" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#0f172a"/>

  <!-- Title -->
  <text x="600" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#e2e8f0" text-anchor="middle">
    Rebuild vs Patch Decision Framework
  </text>

  <!-- Start Node -->
  <rect x="500" y="80" width="200" height="60" fill="#8b5cf6" rx="30"/>
  <text x="600" y="110" font-family="Arial, sans-serif" font-size="14" fill="#ffffff" text-anchor="middle" font-weight="bold">
    Security Issue
  </text>
  <text x="600" y="128" font-family="Arial, sans-serif" font-size="14" fill="#ffffff" text-anchor="middle" font-weight="bold">
    Identified
  </text>

  <!-- Arrow to Question 1 -->
  <line x1="600" y1="140" x2="600" y2="190" stroke="#8b5cf6" stroke-width="3" marker-end="url(#arrowhead)"/>

  <!-- Question 1: Can you explain security model after fix? -->
  <rect x="450" y="190" width="300" height="80" fill="#1e293b" stroke="#3b82f6" stroke-width="2" rx="8"/>
  <text x="600" y="215" font-family="Arial, sans-serif" font-size="13" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    Can you explain security
  </text>
  <text x="600" y="235" font-family="Arial, sans-serif" font-size="13" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    model after fix?
  </text>
  <text x="600" y="260" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle" font-style="italic">
    (Simply, not just implementation)
  </text>

  <!-- Yes/No branches from Q1 -->
  <line x1="450" y1="230" x2="320" y2="230" stroke="#10b981" stroke-width="3" marker-end="url(#arrowhead-green)"/>
  <text x="380" y="220" font-family="Arial, sans-serif" font-size="12" fill="#10b981" font-weight="bold">YES</text>

  <line x1="750" y1="230" x2="880" y2="230" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>
  <text x="810" y="220" font-family="Arial, sans-serif" font-size="12" fill="#ef4444" font-weight="bold">NO</text>

  <!-- Question 2 (YES path): Does fix require changes to >30% of codebase? -->
  <rect x="120" y="190" width="200" height="80" fill="#1e293b" stroke="#3b82f6" stroke-width="2" rx="8"/>
  <text x="220" y="215" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    Does fix require
  </text>
  <text x="220" y="235" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    changes to &gt;30%
  </text>
  <text x="220" y="255" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    of codebase?
  </text>

  <!-- Question 3 (NO path from Q1): Are issues in core architecture? -->
  <rect x="880" y="190" width="200" height="80" fill="#1e293b" stroke="#3b82f6" stroke-width="2" rx="8"/>
  <text x="980" y="215" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    Are issues in core
  </text>
  <text x="980" y="235" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    architecture?
  </text>
  <text x="980" y="255" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle" font-style="italic">
    (Auth/Session/Data)
  </text>

  <!-- Arrows from Q2 -->
  <line x1="220" y1="270" x2="220" y2="340" stroke="#10b981" stroke-width="3" marker-end="url(#arrowhead-green)"/>
  <text x="235" y="310" font-family="Arial, sans-serif" font-size="12" fill="#10b981" font-weight="bold">NO</text>

  <line x1="220" y1="270" x2="150" y2="340" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>
  <text x="165" y="310" font-family="Arial, sans-serif" font-size="12" fill="#ef4444" font-weight="bold">YES</text>

  <!-- Arrows from Q3 -->
  <line x1="980" y1="270" x2="1020" y2="340" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>
  <text x="1010" y="310" font-family="Arial, sans-serif" font-size="12" fill="#ef4444" font-weight="bold">YES</text>

  <line x1="980" y1="270" x2="940" y2="340" stroke="#10b981" stroke-width="3" marker-end="url(#arrowhead-green)"/>
  <text x="945" y="310" font-family="Arial, sans-serif" font-size="12" fill="#10b981" font-weight="bold">NO</text>

  <!-- Question 4 (from Q2 NO): Will patching create more technical debt? -->
  <rect x="120" y="340" width="200" height="80" fill="#1e293b" stroke="#3b82f6" stroke-width="2" rx="8"/>
  <text x="220" y="365" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    Will patching create
  </text>
  <text x="220" y="385" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    more technical
  </text>
  <text x="220" y="405" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    debt?
  </text>

  <!-- Question 5 (from Q3 NO): Will patching create more technical debt? -->
  <rect x="840" y="340" width="200" height="80" fill="#1e293b" stroke="#3b82f6" stroke-width="2" rx="8"/>
  <text x="940" y="365" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    Will patching create
  </text>
  <text x="940" y="385" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    more technical
  </text>
  <text x="940" y="405" font-family="Arial, sans-serif" font-size="12" fill="#e2e8f0" text-anchor="middle" font-weight="bold">
    debt?
  </text>

  <!-- Arrows from Q4 -->
  <line x1="220" y1="420" x2="220" y2="490" stroke="#10b981" stroke-width="3" marker-end="url(#arrowhead-green)"/>
  <text x="235" y="460" font-family="Arial, sans-serif" font-size="12" fill="#10b981" font-weight="bold">NO</text>

  <line x1="220" y1="420" x2="150" y2="490" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>
  <text x="165" y="460" font-family="Arial, sans-serif" font-size="12" fill="#ef4444" font-weight="bold">YES</text>

  <!-- Arrows from Q5 -->
  <line x1="940" y1="420" x2="940" y2="490" stroke="#10b981" stroke-width="3" marker-end="url(#arrowhead-green)"/>
  <text x="955" y="460" font-family="Arial, sans-serif" font-size="12" fill="#10b981" font-weight="bold">NO</text>

  <line x1="940" y1="420" x2="1010" y2="490" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>
  <text x="985" y="460" font-family="Arial, sans-serif" font-size="12" fill="#ef4444" font-weight="bold">YES</text>

  <!-- Outcome 1: Patch and Monitor (Green) -->
  <rect x="440" y="490" width="200" height="100" fill="#10b981" rx="10"/>
  <text x="540" y="525" font-family="Arial, sans-serif" font-size="16" fill="#ffffff" text-anchor="middle" font-weight="bold">
    Patch and
  </text>
  <text x="540" y="548" font-family="Arial, sans-serif" font-size="16" fill="#ffffff" text-anchor="middle" font-weight="bold">
    Monitor
  </text>
  <text x="540" y="572" font-family="Arial, sans-serif" font-size="11" fill="#f0fdf4" text-anchor="middle" font-style="italic">
    Fix specific issues
  </text>

  <!-- Connecting lines to Patch and Monitor -->
  <line x1="220" y1="490" x2="440" y2="540" stroke="#10b981" stroke-width="3" marker-end="url(#arrowhead-green)"/>
  <line x1="940" y1="490" x2="640" y2="540" stroke="#10b981" stroke-width="3" marker-end="url(#arrowhead-green)"/>

  <!-- Outcome 2: Consider Rebuild (Red) -->
  <rect x="560" y="660" width="200" height="100" fill="#ef4444" rx="10"/>
  <text x="660" y="695" font-family="Arial, sans-serif" font-size="16" fill="#ffffff" text-anchor="middle" font-weight="bold">
    Consider
  </text>
  <text x="660" y="718" font-family="Arial, sans-serif" font-size="16" fill="#ffffff" text-anchor="middle" font-weight="bold">
    Rebuild
  </text>
  <text x="660" y="742" font-family="Arial, sans-serif" font-size="11" fill="#fef2f2" text-anchor="middle" font-style="italic">
    Architecture-level fix needed
  </text>

  <!-- Connecting lines to Consider Rebuild -->
  <line x1="150" y1="490" x2="600" y2="660" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>
  <line x1="980" y1="270" x2="980" y2="620" stroke="#ef4444" stroke-width="3"/>
  <line x1="980" y1="620" x2="720" y2="660" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>
  <line x1="1020" y1="490" x2="720" y2="660" stroke="#ef4444" stroke-width="3" marker-end="url(#arrowhead-red)"/>

  <!-- Additional info boxes -->
  <rect x="80" y="780" width="500" height="90" fill="#1e293b" stroke="#10b981" stroke-width="2" rx="8"/>
  <text x="330" y="805" font-family="Arial, sans-serif" font-size="13" fill="#10b981" text-anchor="middle" font-weight="bold">
    Patch and Monitor Indicators:
  </text>
  <text x="330" y="825" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">
    • Isolated vulnerabilities • Clear security model • Minimal ripple effects
  </text>
  <text x="330" y="843" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">
    • Can be tested independently • Doesn't worsen architecture
  </text>
  <text x="330" y="861" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">
    Action: Fix, document, add monitoring, plan for improvement
  </text>

  <rect x="620" y="780" width="500" height="90" fill="#1e293b" stroke="#ef4444" stroke-width="2" rx="8"/>
  <text x="870" y="805" font-family="Arial, sans-serif" font-size="13" fill="#ef4444" text-anchor="middle" font-weight="bold">
    Rebuild Indicators:
  </text>
  <text x="870" y="825" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">
    • Systemic issues • No clear security model • Changes cascade
  </text>
  <text x="870" y="843" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">
    • Core auth/session/data problems • Patch adds complexity
  </text>
  <text x="870" y="861" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8" text-anchor="middle">
    Action: Plan v2 with proper security architecture from start
  </text>
</svg>