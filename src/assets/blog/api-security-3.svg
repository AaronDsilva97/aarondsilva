<svg viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowGray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Dark background -->
  <rect width="1400" height="900" fill="#0f172a"/>

  <!-- Title -->
  <text x="700" y="40" text-anchor="middle" fill="#f1f5f9" font-size="24" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Healthcare Authorization Model</text>
  <text x="700" y="65" text-anchor="middle" fill="#94a3b8" font-size="14" font-family="system-ui, -apple-system, sans-serif">Layered Authorization Architecture with RBAC + ABAC</text>

  <!-- Main Architecture Layers -->

  <!-- Layer 1: Identity Layer -->
  <g id="identity-layer">
    <rect x="50" y="100" width="1300" height="120" rx="8" fill="#1e293b" stroke="#3b82f6" stroke-width="3"/>
    <text x="700" y="130" text-anchor="middle" fill="#3b82f6" font-size="18" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Layer 1: Identity Layer</text>
    <text x="700" y="152" text-anchor="middle" fill="#93c5fd" font-size="12" font-family="system-ui, -apple-system, sans-serif">User Authentication &amp; Role Assignment</text>

    <!-- Identity Components -->
    <rect x="80" y="165" width="180" height="40" rx="6" fill="#1e3a8a" stroke="#3b82f6" stroke-width="1"/>
    <text x="170" y="188" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">OAuth 2.0 + SMART</text>

    <rect x="280" y="165" width="180" height="40" rx="6" fill="#1e3a8a" stroke="#3b82f6" stroke-width="1"/>
    <text x="370" y="182" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">User: Dr. Jane Smith</text>
    <text x="370" y="197" text-anchor="middle" fill="#93c5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">ID: user_abc123</text>

    <rect x="480" y="165" width="180" height="40" rx="6" fill="#1e3a8a" stroke="#3b82f6" stroke-width="1"/>
    <text x="570" y="182" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">Role: Physician</text>
    <text x="570" y="197" text-anchor="middle" fill="#93c5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">Department: Cardiology</text>

    <rect x="680" y="165" width="180" height="40" rx="6" fill="#1e3a8a" stroke="#3b82f6" stroke-width="1"/>
    <text x="770" y="182" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">Facility: Hospital A</text>
    <text x="770" y="197" text-anchor="middle" fill="#93c5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">Location: ER Wing</text>

    <rect x="880" y="165" width="180" height="40" rx="6" fill="#1e3a8a" stroke="#3b82f6" stroke-width="1"/>
    <text x="970" y="182" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">Session: Active</text>
    <text x="970" y="197" text-anchor="middle" fill="#93c5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">On Duty: Yes</text>

    <rect x="1080" y="165" width="240" height="40" rx="6" fill="#1e3a8a" stroke="#3b82f6" stroke-width="1"/>
    <text x="1200" y="182" text-anchor="middle" fill="#93c5fd" font-size="11" font-family="system-ui, -apple-system, sans-serif">Token Valid: 14min remaining</text>
    <text x="1200" y="197" text-anchor="middle" fill="#93c5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">Scope: patient/*.read</text>
  </g>

  <!-- Arrow down -->
  <path d="M 700 230 L 700 260" stroke="#64748b" stroke-width="3" marker-end="url(#arrowGray)"/>

  <!-- Layer 2: RBAC Layer -->
  <g id="rbac-layer">
    <rect x="50" y="270" width="1300" height="140" rx="8" fill="#1e293b" stroke="#8b5cf6" stroke-width="3"/>
    <text x="700" y="300" text-anchor="middle" fill="#8b5cf6" font-size="18" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Layer 2: RBAC Layer (Role-Based Access Control)</text>
    <text x="700" y="322" text-anchor="middle" fill="#c4b5fd" font-size="12" font-family="system-ui, -apple-system, sans-serif">Coarse-grained permissions based on roles</text>

    <!-- Role Cards -->
    <rect x="80" y="335" width="140" height="60" rx="6" fill="#581c87" stroke="#8b5cf6" stroke-width="2"/>
    <text x="150" y="355" text-anchor="middle" fill="#c4b5fd" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Doctor</text>
    <text x="150" y="372" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ Read patient records</text>
    <text x="150" y="386" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ Write prescriptions</text>

    <rect x="240" y="335" width="140" height="60" rx="6" fill="#581c87" stroke="#8b5cf6" stroke-width="2"/>
    <text x="310" y="355" text-anchor="middle" fill="#c4b5fd" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Nurse</text>
    <text x="310" y="372" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ Read patient vitals</text>
    <text x="310" y="386" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ Update care notes</text>

    <rect x="400" y="335" width="140" height="60" rx="6" fill="#581c87" stroke="#8b5cf6" stroke-width="2"/>
    <text x="470" y="355" text-anchor="middle" fill="#c4b5fd" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Admin</text>
    <text x="470" y="372" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ Manage users</text>
    <text x="470" y="386" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ View audit logs</text>

    <rect x="560" y="335" width="140" height="60" rx="6" fill="#581c87" stroke="#8b5cf6" stroke-width="2"/>
    <text x="630" y="355" text-anchor="middle" fill="#c4b5fd" font-size="12" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Patient</text>
    <text x="630" y="372" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ Read own records</text>
    <text x="630" y="386" text-anchor="middle" fill="#c4b5fd" font-size="10" font-family="system-ui, -apple-system, sans-serif">âœ“ Grant access</text>

    <rect x="720" y="335" width="280" height="60" rx="6" fill="#312e81" stroke="#8b5cf6" stroke-width="2"/>
    <text x="860" y="352" text-anchor="middle" fill="#c4b5fd" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">RBAC Decision Point</text>
    <text x="860" y="368" text-anchor="middle" fill="#e9d5ff" font-size="10" font-family="system-ui, -apple-system, sans-serif">Question: "Is this user a doctor?"</text>
    <text x="860" y="383" text-anchor="middle" fill="#10b981" font-size="10" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Answer: YES âœ“ (Dr. Jane Smith)</text>

    <rect x="1020" y="335" width="300" height="60" rx="6" fill="#422006" stroke="#f59e0b" stroke-width="2"/>
    <text x="1170" y="355" text-anchor="middle" fill="#fbbf24" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">âš  RBAC Limitation</text>
    <text x="1170" y="372" text-anchor="middle" fill="#fde68a" font-size="10" font-family="system-ui, -apple-system, sans-serif">RBAC alone can't answer:</text>
    <text x="1170" y="387" text-anchor="middle" fill="#fde68a" font-size="10" font-family="system-ui, -apple-system, sans-serif">"Can she access THIS specific patient?"</text>
  </g>

  <!-- Arrow down -->
  <path d="M 700 420 L 700 450" stroke="#64748b" stroke-width="3" marker-end="url(#arrowGray)"/>

  <!-- Layer 3: ABAC Layer -->
  <g id="abac-layer">
    <rect x="50" y="460" width="1300" height="180" rx="8" fill="#1e293b" stroke="#10b981" stroke-width="3"/>
    <text x="700" y="490" text-anchor="middle" fill="#10b981" font-size="18" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Layer 3: ABAC Layer (Attribute-Based Access Control)</text>
    <text x="700" y="512" text-anchor="middle" fill="#6ee7b7" font-size="12" font-family="system-ui, -apple-system, sans-serif">Fine-grained patient-level authorization</text>

    <!-- ABAC Decision Box -->
    <rect x="80" y="530" width="520" height="90" rx="8" fill="#064e3b" stroke="#10b981" stroke-width="2"/>
    <text x="340" y="555" text-anchor="middle" fill="#6ee7b7" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Authorization Decision: Can Dr. Smith access Patient 123?</text>

    <g transform="translate(100, 565)">
      <text x="0" y="15" fill="#d1fae5" font-size="11" font-family="system-ui, -apple-system, sans-serif">âœ“ Patient Attribution: Dr. Smith is assigned to Patient 123</text>
      <text x="0" y="32" fill="#d1fae5" font-size="11" font-family="system-ui, -apple-system, sans-serif">âœ“ Facility Access: Dr. Smith works at Hospital A (patient location)</text>
      <text x="0" y="49" fill="#d1fae5" font-size="11" font-family="system-ui, -apple-system, sans-serif">âœ“ Time Restriction: Dr. Smith is on duty (shift: 8am-6pm)</text>
    </g>

    <!-- Attributes Boxes -->
    <rect x="620" y="530" width="180" height="45" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1"/>
    <text x="710" y="548" text-anchor="middle" fill="#6ee7b7" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Patient Attribution</text>
    <text x="710" y="563" text-anchor="middle" fill="#d1fae5" font-size="10" font-family="system-ui, -apple-system, sans-serif">Assigned patients list</text>

    <rect x="820" y="530" width="180" height="45" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1"/>
    <text x="910" y="548" text-anchor="middle" fill="#6ee7b7" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Facility Context</text>
    <text x="910" y="563" text-anchor="middle" fill="#d1fae5" font-size="10" font-family="system-ui, -apple-system, sans-serif">Hospital A, ER Wing</text>

    <rect x="1020" y="530" width="180" height="45" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1"/>
    <text x="1110" y="548" text-anchor="middle" fill="#6ee7b7" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Time Context</text>
    <text x="1110" y="563" text-anchor="middle" fill="#d1fae5" font-size="10" font-family="system-ui, -apple-system, sans-serif">Current shift hours</text>

    <rect x="620" y="590" width="180" height="45" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1"/>
    <text x="710" y="608" text-anchor="middle" fill="#6ee7b7" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Delegation Chain</text>
    <text x="710" y="623" text-anchor="middle" fill="#d1fae5" font-size="10" font-family="system-ui, -apple-system, sans-serif">Who granted access</text>

    <rect x="820" y="590" width="180" height="45" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1"/>
    <text x="910" y="608" text-anchor="middle" fill="#6ee7b7" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Purpose of Access</text>
    <text x="910" y="623" text-anchor="middle" fill="#d1fae5" font-size="10" font-family="system-ui, -apple-system, sans-serif">Treatment / Payment</text>

    <rect x="1020" y="590" width="180" height="45" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1"/>
    <text x="1110" y="608" text-anchor="middle" fill="#6ee7b7" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Consent Status</text>
    <text x="1110" y="623" text-anchor="middle" fill="#d1fae5" font-size="10" font-family="system-ui, -apple-system, sans-serif">Patient consent given</text>

    <!-- Final Decision -->
    <rect x="1220" y="545" width="110" height="70" rx="6" fill="#065f46" stroke="#10b981" stroke-width="3"/>
    <text x="1275" y="570" text-anchor="middle" fill="#10b981" font-size="16" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">ALLOW</text>
    <text x="1275" y="590" text-anchor="middle" fill="#d1fae5" font-size="11" font-family="system-ui, -apple-system, sans-serif">Access</text>
    <text x="1275" y="605" text-anchor="middle" fill="#d1fae5" font-size="11" font-family="system-ui, -apple-system, sans-serif">Granted âœ“</text>
  </g>

  <!-- Break Glass Emergency Access -->
  <g id="break-glass">
    <rect x="50" y="660" width="640" height="120" rx="8" fill="#450a0a" stroke="#ef4444" stroke-width="3"/>
    <text x="370" y="690" text-anchor="middle" fill="#ef4444" font-size="18" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">ðŸš¨ Break Glass: Emergency Access</text>
    <text x="370" y="712" text-anchor="middle" fill="#fca5a5" font-size="12" font-family="system-ui, -apple-system, sans-serif">Bypasses normal authorization when patient arrives unconscious</text>

    <rect x="80" y="725" width="160" height="40" rx="6" fill="#7f1d1d" stroke="#ef4444" stroke-width="1"/>
    <text x="160" y="742" text-anchor="middle" fill="#fca5a5" font-size="11" font-family="system-ui, -apple-system, sans-serif">1. Grant immediate</text>
    <text x="160" y="757" text-anchor="middle" fill="#fca5a5" font-size="11" font-family="system-ui, -apple-system, sans-serif">access to ER doctor</text>

    <rect x="260" y="725" width="160" height="40" rx="6" fill="#7f1d1d" stroke="#ef4444" stroke-width="1"/>
    <text x="340" y="742" text-anchor="middle" fill="#fca5a5" font-size="11" font-family="system-ui, -apple-system, sans-serif">2. Log everything</text>
    <text x="340" y="757" text-anchor="middle" fill="#fca5a5" font-size="11" font-family="system-ui, -apple-system, sans-serif">to audit trail</text>

    <rect x="440" y="725" width="160" height="40" rx="6" fill="#7f1d1d" stroke="#ef4444" stroke-width="1"/>
    <text x="520" y="742" text-anchor="middle" fill="#fca5a5" font-size="11" font-family="system-ui, -apple-system, sans-serif">3. Alert security</text>
    <text x="520" y="757" text-anchor="middle" fill="#fca5a5" font-size="11" font-family="system-ui, -apple-system, sans-serif">team in real-time</text>
  </g>

  <!-- Audit & Compliance -->
  <g id="audit-layer">
    <rect x="710" y="660" width="640" height="120" rx="8" fill="#1e293b" stroke="#ec4899" stroke-width="3"/>
    <text x="1030" y="690" text-anchor="middle" fill="#ec4899" font-size="18" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Audit &amp; Compliance Logging</text>
    <text x="1030" y="712" text-anchor="middle" fill="#f9a8d4" font-size="12" font-family="system-ui, -apple-system, sans-serif">Every authorization decision is logged immutably</text>

    <rect x="740" y="725" width="260" height="40" rx="6" fill="#831843" stroke="#ec4899" stroke-width="1"/>
    <text x="870" y="740" text-anchor="middle" fill="#f9a8d4" font-size="10" font-family="system-ui, -apple-system, sans-serif">Logged: User ID, Patient ID, Timestamp</text>
    <text x="870" y="755" text-anchor="middle" fill="#f9a8d4" font-size="10" font-family="system-ui, -apple-system, sans-serif">IP Address, Decision (Allow/Deny), Context</text>

    <rect x="1020" y="725" width="160" height="40" rx="6" fill="#831843" stroke="#ec4899" stroke-width="1"/>
    <text x="1100" y="742" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">HIPAA Requirement</text>
    <text x="1100" y="757" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">Retention: 6 years</text>

    <rect x="1200" y="725" width="130" height="40" rx="6" fill="#831843" stroke="#ec4899" stroke-width="1"/>
    <text x="1265" y="742" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">Breach</text>
    <text x="1265" y="757" text-anchor="middle" fill="#f9a8d4" font-size="11" font-family="system-ui, -apple-system, sans-serif">Detection</text>
  </g>

  <!-- Example Scenarios -->
  <g id="example-scenarios">
    <rect x="50" y="800" width="630" height="80" rx="8" fill="#1e293b" stroke="#64748b" stroke-width="2"/>
    <text x="365" y="825" text-anchor="middle" fill="#cbd5e1" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Normal Access Example</text>
    <text x="365" y="845" text-anchor="middle" fill="#94a3b8" font-size="11" font-family="system-ui, -apple-system, sans-serif">Dr. Smith (Physician) requests Patient 123 record at Hospital A</text>
    <text x="365" y="860" text-anchor="middle" fill="#10b981" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">âœ“ RBAC: YES (is a doctor) â†’ ABAC: YES (attributed patient) â†’ ALLOW</text>
    <text x="365" y="873" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="system-ui, -apple-system, sans-serif">Log: 2025-12-08 14:30:22 | Dr.Smith | Patient123 | Allow | Treatment</text>
  </g>

  <g id="deny-scenario">
    <rect x="710" y="800" width="640" height="80" rx="8" fill="#1e293b" stroke="#64748b" stroke-width="2"/>
    <text x="1030" y="825" text-anchor="middle" fill="#cbd5e1" font-size="13" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">Denied Access Example</text>
    <text x="1030" y="845" text-anchor="middle" fill="#94a3b8" font-size="11" font-family="system-ui, -apple-system, sans-serif">Dr. Jones (Physician) requests Patient 456 record at Hospital B</text>
    <text x="1030" y="860" text-anchor="middle" fill="#ef4444" font-size="11" font-weight="bold" font-family="system-ui, -apple-system, sans-serif">âœ“ RBAC: YES (is a doctor) â†’ âœ— ABAC: NO (not attributed patient) â†’ DENY</text>
    <text x="1030" y="873" text-anchor="middle" fill="#94a3b8" font-size="10" font-family="system-ui, -apple-system, sans-serif">Log: 2025-12-08 14:31:05 | Dr.Jones | Patient456 | Deny | Security alert triggered</text>
  </g>

</svg>